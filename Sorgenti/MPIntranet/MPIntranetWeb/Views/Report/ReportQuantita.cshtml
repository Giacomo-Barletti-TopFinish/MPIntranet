@using MPIntranet.Models.Common
@{
    ViewBag.Title = "Report Quantita'";
    Layout = "~/Views/Shared/_LayoutApplication.cshtml";
}


<div class="content-top">
    <h2>Report Quantita'</h2>
</div>
<div class="row col-lg-6">
    @Html.Label("Report")
    @*@Html.DropDownList("ddlReparti", new SelectList(@ViewData["Reparti"] as List<MPIntranetListItem>, "Value", "Text"), new { @class = "form-control input-sm", @id = "ddlReparti" })*@
    @*<div class="col-lg-2">
        <input type="button" onclick="caricaDati();" class="btn btn-primary" value="Ricerca" />*@
    </div>
    <div class="col-lg-2">
        <input type="button" onclick="Export();" class="btn btn-primary" value="Export" />
    </div>
</div>

<br />
<div class="col-md-12" style="font-size:8px" id="divReportQuantita"></div>

<script language="javascript" type="text/javascript">
    $(function ()
    {
        //$("#ddlReparti").change(function () {
        //    var selectedText = $(this).find("option:selected").text();
        //    var selectedValue = $(this).val();
        //    caricaDati(selectedValue);
        //});

        @*$('#ddlReparti').val('@MPIntranet.Entities.ElementiVuoti.TuttiReparti.ToString()').trigger("change");*@
    });

    function caricaDati()
        {
            var idreport = $('#ddlReport').val();
            if (idreport == null || idreport == '')
                idreport = '@MPIntranet.Entities.ElementiVuoti.TutteQuantita.ToString()';

         var url = '@Url.Action("CaricaReportQuantita", "Report")';
        $.ajax({
            url: url,
            data: {
                idReport: idreport
            },
            cache: false,
            type: "POST",
            success: function (data)
            {
                $('#divReportQuantita').html(data).show();
            },
            error: function (response)
            {
                document.open();
                document.write(response.responseText);
                document.close();
            }
        });
    }

  function Export()
    {

     var idreparto = $('#ddlReport').val();
            if (idreport == null || idreport == '')
          idreparto = '@MPIntranet.Entities.ElementiVuoti.TutteQuantita.ToString()';

        var url = '@Url.Action("ExportExcel", "Report")';
      url = url + '?idReport=' + idreport;


        var win = window.open(url, '_blank');
        win.document.title = "Export";
        win.focus();


    }
    











</script>
