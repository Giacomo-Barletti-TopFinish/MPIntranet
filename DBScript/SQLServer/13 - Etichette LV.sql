USE MPI_TEST
GO

CREATE TABLE [ETICHETTELV]
(
 [IDARTICOLI]        int IDENTITY (1, 1) NOT NULL ,
 [IDMAGAZZ] NVARCHAR(20) NOT NULL,
	[CODICEMODELLO] NVARCHAR(15 ) NOT NULL , 
	[CODICECOLORE] NVARCHAR(15 ) NOT NULL , 
	[COLORE] NVARCHAR(30 ) NOT NULL , 
	[SKU] NVARCHAR(12 ) NOT NULL , 
	[MODELLO] NVARCHAR(50 ) NOT NULL , 
	[PARZIALE] NVARCHAR(20 ), 
	[RTT] NVARCHAR(20 ),
	 CONSTRAINT PK_ETICHETTELV PRIMARY KEY (IDARTICOLI)
);
GO

CREATE INDEX IDX_ETICHETTE_1 ON ETICHETTELV(IDMAGAZZ)
GO

Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100007FIB85A01','MLV0099',' ',' ','R00021704F','924003..-TZ BATON-PVD NOIR MAT SABLE''','RTT057591','RTT057591');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100008FIB86A01','MLV0099','  ','  ','R100126095','90T002..- TZ BATON-NOIR BRILLIANT',' RTT057591','RTT057591');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100008FIB85A01','MLV0099',' ',' ','R00021703F','924002-TZ BATON-PVD NOIR MAT SABLE''','RTT057591','RTT057591');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100008FIB89A01','MLV0099',' ',' ','R00021706F','949002..-TZ BATON-LAITON POLI OXYDE''','RTT057591','RTT057591');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100008FIB56A01','MLV0099',' ',' ','R100281750','964002..- TZ BATON-ARGENT VIELLI A CONFIRMER',' RTT057591','RTT057591');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100008FIB73A01','MLV0099','CODICE COLORE','COLORE','R00021712F','991002..-TZ BATON-PALLADIUM BRILLANT ANTIAL.','RTT057591','RTT057591');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100008FIB73A01','MLV0099','CODICE COLORE','COLORE','R00021712F','991002..-TZ BATON-PALLADIUM BRILLANT ANTIAL.','RTT057591','RTT057591');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100009FIB56A01','MLV0099',' ',' ','R100281753','964001..-TZ BATON-ARGENT VIEILLI A CONFIRMER','RTT057591','RTT057591');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-BTT100004FIB90A01','MLV0121',' ',' ','R100314725','997020MM - BT METAL LV ','RBT061767','RBT061767');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR700018FIB73A01','MLV0222',' ',' ','R100319160','991XXXMM-TZ TROMBONE + MEDAILLON LV- PALLADIUM','RTT097514','RTT097514');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR700018FIB56A01','MLV0222',' ',' ','R100319161','964XXXMM-TZ TA','RTT097514','RTT097514');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-SCO100011FIB91A01','MLV0165',' ',' ','R100317166','CADRE BIKER TUM','RCC077081','RCC077081');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-SCO100011FIB86A01','MLV0165',' ',' ','R100303326','CADRE BIKER TISSU EPAIS CONTOURS DEFORM','RCC077081','RCC077081');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-SCO100012FIB91A01','MLV0165',' ',' ','R100317167','CADRE BIKER T','RCC077081','RCC077081');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-SCO100012FIB86A01','MLV0165',' ',' ','R100296658','CADRE BIKER ','RCC077081','RCC077081');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR700018FIB90A01','MLV0222',' ',' ','R100317959','997XXXMM-TZ TROMBONE + MEDAILLON LV- OR 1N','RTT097514','RTT097514');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100019FIB73A01','MLV0056','   ','   ','R100147848','9P1XXXMM-TZ RING-PALLADIUM 0,5',' RTT072132','RTT072132');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100010FIC45A01','MLV0075',' ',' ','R00025944E','TIRALAMPO OTT.S/PB C/2 27 ',' RCC077081','RCC077081');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-BTT100005FIB90A01','MLV0105',' ',' ','R100305017','BT MILITAIRE 12MM-OR1N',' RBT059883','RBT059883');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-SCO100004FIB86A01','MLV0165',' ',' ','R100211320','CADRE BIKER','RCC077081','RCC077081');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-SCO100004FIC48A01','MLV0165','MLV0165-30-','LV613','R100308014','CADRE BIKER T','RCC077081','RCC077081');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-SCO100002FIC54A01','MLV0165ZAMA',' ',' ','R100324626','CADRE BIKER ',' R100324626',' RCC077081');
GO


CREATE VIEW CROSSREFERENCE AS
select *  from [TEST].[dbo].[MetalPlus_WS$Item Cross Reference$437dbf0e-84ff-417a-965d-ed2bb9650972] WITH(NOLOCK)


USE MPI


CREATE TABLE [ETICHETTELV]
(
 [IDARTICOLI]        int IDENTITY (1, 1) NOT NULL ,
 [IDMAGAZZ] NVARCHAR(20) NOT NULL,
	[CODICEMODELLO] NVARCHAR(15 ) NOT NULL , 
	[CODICECOLORE] NVARCHAR(15 ) NOT NULL , 
	[COLORE] NVARCHAR(30 ) NOT NULL , 
	[SKU] NVARCHAR(12 ) NOT NULL , 
	[MODELLO] NVARCHAR(50 ) NOT NULL , 
	[PARZIALE] NVARCHAR(20 ), 
	[RTT] NVARCHAR(20 ),
		 CONSTRAINT PK_ETICHETTELV PRIMARY KEY (IDARTICOLI)
);
GO

CREATE INDEX IDX_ETICHETTE_1 ON ETICHETTELV(IDMAGAZZ)
GO

Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100007FIB85A01','MLV0099',' ',' ','R00021704F','924003..-TZ BATON-PVD NOIR MAT SABLE''','RTT057591','RTT057591');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100008FIB86A01','MLV0099','  ','  ','R100126095','90T002..- TZ BATON-NOIR BRILLIANT',' RTT057591','RTT057591');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100008FIB85A01','MLV0099',' ',' ','R00021703F','924002-TZ BATON-PVD NOIR MAT SABLE''','RTT057591','RTT057591');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100008FIB89A01','MLV0099',' ',' ','R00021706F','949002..-TZ BATON-LAITON POLI OXYDE''','RTT057591','RTT057591');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100008FIB56A01','MLV0099',' ',' ','R100281750','964002..- TZ BATON-ARGENT VIELLI A CONFIRMER',' RTT057591','RTT057591');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100008FIB73A01','MLV0099','CODICE COLORE','COLORE','R00021712F','991002..-TZ BATON-PALLADIUM BRILLANT ANTIAL.','RTT057591','RTT057591');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100008FIB73A01','MLV0099','CODICE COLORE','COLORE','R00021712F','991002..-TZ BATON-PALLADIUM BRILLANT ANTIAL.','RTT057591','RTT057591');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100009FIB56A01','MLV0099',' ',' ','R100281753','964001..-TZ BATON-ARGENT VIEILLI A CONFIRMER','RTT057591','RTT057591');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-BTT100004FIB90A01','MLV0121',' ',' ','R100314725','997020MM - BT METAL LV ','RBT061767','RBT061767');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR700018FIB73A01','MLV0222',' ',' ','R100319160','991XXXMM-TZ TROMBONE + MEDAILLON LV- PALLADIUM','RTT097514','RTT097514');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR700018FIB56A01','MLV0222',' ',' ','R100319161','964XXXMM-TZ TA','RTT097514','RTT097514');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-SCO100011FIB91A01','MLV0165',' ',' ','R100317166','CADRE BIKER TUM','RCC077081','RCC077081');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-SCO100011FIB86A01','MLV0165',' ',' ','R100303326','CADRE BIKER TISSU EPAIS CONTOURS DEFORM','RCC077081','RCC077081');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-SCO100012FIB91A01','MLV0165',' ',' ','R100317167','CADRE BIKER T','RCC077081','RCC077081');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-SCO100012FIB86A01','MLV0165',' ',' ','R100296658','CADRE BIKER ','RCC077081','RCC077081');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR700018FIB90A01','MLV0222',' ',' ','R100317959','997XXXMM-TZ TROMBONE + MEDAILLON LV- OR 1N','RTT097514','RTT097514');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100019FIB73A01','MLV0056','   ','   ','R100147848','9P1XXXMM-TZ RING-PALLADIUM 0,5',' RTT072132','RTT072132');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-TIR100010FIC45A01','MLV0075',' ',' ','R00025944E','TIRALAMPO OTT.S/PB C/2 27 ',' RCC077081','RCC077081');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-BTT100005FIB90A01','MLV0105',' ',' ','R100305017','BT MILITAIRE 12MM-OR1N',' RBT059883','RBT059883');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-SCO100004FIB86A01','MLV0165',' ',' ','R100211320','CADRE BIKER','RCC077081','RCC077081');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-SCO100004FIC48A01','MLV0165','MLV0165-30-','LV613','R100308014','CADRE BIKER T','RCC077081','RCC077081');
Insert into ETICHETTELV (IDMAGAZZ,CODICEMODELLO,CODICECOLORE,COLORE,SKU,MODELLO,PARZIALE,RTT) values ('A-SCO100002FIC54A01','MLV0165ZAMA',' ',' ','R100324626','CADRE BIKER ',' R100324626',' RCC077081');
GO


CREATE VIEW CROSSREFERENCE AS
select *  from [PROD].[dbo].[MetalPlus$Item Cross Reference$437dbf0e-84ff-417a-965d-ed2bb9650972] WITH(NOLOCK)
