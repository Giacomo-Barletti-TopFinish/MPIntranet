

 CREATE TABLE TELAI (  
    IDTELAIO NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,  
    CODICE VARCHAR2(10) NOT NULL ,     
    PEZZI NUMBER NULL ,     
    TIPOMONTAGGIO VARCHAR2(25) NULL,
    COSTOSTANDARD FLOAT NULL,
  CANCELLATO VARCHAR2(1) NOT NULL,
  DATAMODIFICA DATE NOT NULL,
  UTENTEMODIFICA VARCHAR2(50) NOT NULL,
   CONSTRAINT PK_IDTELAIO PRIMARY KEY (IDTELAIO)
   );

CREATE UNIQUE INDEX IDX_TELAIO_A ON TELAI(CODICE,PEZZI);

 CREATE TABLE TELAI_LOG (  
    IDTELAIO NUMBER NULL,  
    CODICE VARCHAR2(10)  NULL ,     
    PEZZI NUMBER NULL ,     
    TIPOMONTAGGIO VARCHAR2(25) NULL,
    COSTOSTANDARD FLOAT NULL,
  CANCELLATO VARCHAR2(1)  NULL,
  DATAMODIFICA DATE  NULL,
  UTENTEMODIFICA VARCHAR2(50)  NULL
   );

  create or replace TRIGGER TELAI_LOG
AFTER INSERT OR UPDATE ON TELAI
FOR EACH ROW
BEGIN
INSERT INTO TELAI_LOG(IDTELAIO,CODICE,PEZZI,TIPOMONTAGGIO,COSTOSTANDARD,CANCELLATO,DATAMODIFICA,UTENTEMODIFICA)
VALUES
(:NEW.IDTELAIO,:NEW.CODICE,:NEW.PEZZI,:NEW.TIPOMONTAGGIO,:NEW.COSTOSTANDARD,:NEW.CANCELLATO,:NEW.DATAMODIFICA,:NEW.UTENTEMODIFICA);
END;


ALTER TABLE PROCESSI 
ADD IDTELAIO NUMBER NULL;
ALTER TABLE PROCESSI 
  ADD FOREIGN KEY (IDTELAIO) REFERENCES TELAI (IDTELAIO) ENABLE;

ALTER TABLE PROCESSI_LOG
ADD IDTELAIO NUMBER NULL;

 create or replace TRIGGER PROCESSI_LOG
AFTER INSERT OR UPDATE ON PROCESSI 
FOR EACH ROW
BEGIN
INSERT INTO PROCESSI_LOG(IDPROCESSO,IDIMPIANTO,IDARTICOLO,DESCRIZIONE,CANCELLATO,DATAMODIFICA,UTENTEMODIFICA,IDTELAIO)
VALUES
(:NEW.IDPROCESSO,:NEW.IDIMPIANTO,:NEW.IDARTICOLO,:NEW.DESCRIZIONE,:NEW.CANCELLATO,:NEW.DATAMODIFICA,:NEW.UTENTEMODIFICA,:NEW.IDTELAIO);
END;


INSERT INTO TELAI(IDTELAIO,CODICE,PEZZI,TIPOMONTAGGIO,COSTOSTANDARD,CANCELLATO,DATAMODIFICA,UTENTEMODIFICA)VALUES(NULL,'---',NULL,NULL,NULL,'N',SYSDATE,'IMPIANTO');

INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('46', '800', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('46', '512', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('47', '40', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('47', '154', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('47', '360', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('47', '390', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('48', '72', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('49', '80', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('36', '104', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('36', '150', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('37', '216', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('38', '58', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('38', '160', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('40', '320', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('41', '80', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('42', '80', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('43', '200', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('45', '272', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('23', '80', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('23', '200', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('23', '132', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('24', '45', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('23', '104', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('24', '320', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('25', '464', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('25', '20', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('26', '35', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('27', '40', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('28', '35', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('29', '27', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('30', '110', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('31', '242', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('32', '90', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('33', '75', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('34', '144', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('35', '189', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('5', '200', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('5', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('6', '1200', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('6', '200', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('7', '500', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('7', '800', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('7', '390', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('8', '500', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('9', '512', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('9', '256', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('10', '512', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('10', '256', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('11', '144', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('11', '294', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('12', '30', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('12', '84', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('12', '209', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('13', '100', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('14', '100', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('15', '8', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('16', '156', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('17', '156', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('18', '110', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('19', '110', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('20', '42', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
INSERT INTO "MPI"."TELAI" (CODICE, PEZZI, CANCELLATO, DATAMODIFICA, UTENTEMODIFICA) VALUES ('21', '42', 'N', TO_DATE('2020-03-26 00:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'IMPIANTO')
